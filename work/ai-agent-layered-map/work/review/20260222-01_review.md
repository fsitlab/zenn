# レビュー結果

## mappingの見直し ✅対応済み
mapping.mdについて、主体のマークと、影響のマークを変えたい、
主体を✅、利用する機能を🔧　にして。
→ **06_早見表.mdを5層モデルで更新、✅/🔧形式に変更**

## 通信層の強化 ✅対応済み
元記事に合った、以下要素が無くなっている
マルチモーダルAPI形式と、ファイル転送方式
→ **02_通信層.mdに第6章「マルチモーダルAPI形式」、第7章「完全版JSON」を追加**

## 古い分類体系の修正 ✅対応済み
多くの章で古い分類体系が使われている。新しい5層分類にして。
→ **全ドキュメントの丸数字（①②③④⑤）と旧層名を5層モデルに統一**

### 修正対象（完了）
- [x] 01_LLM層.md
- [x] 03_アプリ層.md
- [x] 04_外部ツール層.md
- [x] 07_Claude_Cowork.md
- [x] 08_相性問題.md
- [x] 09_付録.md

## アスキー図のマーメード図化 ✅対応済み
04_外部ツール層の利用フローについて、マーメード図のフロー図をつかって分かりやすく解説して。
MCPやRAGの違いなど。
また、A2A、サブエージェント、Agent Teamsもフローが異なるよね？
フロー図で分かりやすくして。

→ **04_外部ツール層.mdに以下のMermaid図を追加**:
- 従来型RAGフロー（sequenceDiagram）
- Tool型RAGフロー（sequenceDiagram）
- MCPフロー（sequenceDiagram）
- サブエージェントフロー（sequenceDiagram）
- Agent Teamsフロー（sequenceDiagram）
- A2Aフロー（sequenceDiagram）
- 3方式比較図（flowchart）

## エージェント章の分離 ✅対応済み
AI Agentsについて、長くなり過ぎたので、04_bみたいに別の章にまとめて解説して。
→ **章を分離**:
- 04_外部ツール層.md → 04_外部ツール層.md (a) MCP・RAG・ツール編
- 新規作成: 04_b_エージェント連携.md — サブエージェント、Agent Teams、A2Aの詳細解説

## エージェント概念のハルシネーション ✅対応済み
・サブエージェントでも、複数の子エージェントはできます。
・サブエージェントとA2A、Agent Teamsのフロー図について、今回の5層分離がどう対応するかもわかるようにして。今のマーメード図には、それぞれのアクターが何層か、明記して。
また、１～５層でかいたマーメードずでも、A2A、Agent Teams、サブエージェントについて、通信方式をかいて

Agent Cardに書かれた情報は、どうやって最終的にLLMに伝わる？

AIエージェントの種類も概形を正しい用語調査して解説して

→ **04_b_エージェント連携.mdを大幅修正**:
- サブエージェントの複数子起動可能を明記
- 全Mermaid図に層番号を明記（例: `第3層<br/>アプリ層`）
- 5層モデルでの通信経路図を追加（セクション6）
- Agent Cardの情報伝達経路を追加（セクション5-4）
- AIエージェントの5つの主要パターンを追加（セクション2）:
  - Workflow型、Tool Use型、Multi-Agent Orchestration型、Blackboard型、Message Passing型

## 04_cの追加 ✅対応済み
Hookやskillなど、.claude配下のファイルの役割を、５層モデルに沿って解説して。
gooseやpermissionなど、いろいろ何でも解説して。

→ **新規作成: 04_c_Claude設定ファイル.md**
- CLAUDE.md、Skills、Agents、Hooks、settings.json、.mcp.json、Permissionsを5層モデルで解説

## 具体製品の解説 ✅対応済み
７章は具体的な製品を５層モデルで解説したい。
製品ごとにmdファイルを分けて、07_a、07_bみたいに。

## アスキーアートの修正 ✅対応済み
以下みたいなアスキーアートはフォーマットが崩れているので、マーメード図に変更して。
色んなドキュメントで同じ課題があるので、横断的に修正して。
→ **全ドキュメントのアスキーアートをMermaid flowchart形式に変換**
```
┌─────────────────────────────────────────────────────────────┐
│  第5層: プレゼンテーション層                                 │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ Dify WebUI                                          │   │
│  │ - チャットインターフェース                           │   │
│  │ - ワークフロービルダー（ビジュアルエディタ）          │   │
│  │ - ナレッジベース管理画面                             │   │
│  │ - アプリ設定・公開管理                               │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  第4層: 外部ツール層                                         │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ Dify のツール連携                                    │   │
│  │ - ナレッジベース（ベクトルDB: Weaviate, Qdrant等）    │   │
│  │ - 組み込みツール（Web検索、天気、計算等）             │   │
│  │ - カスタムAPI連携（外部REST API呼び出し）             │   │
│  │ - コード実行（Python/JavaScript サンドボックス）     │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  第3層: アプリ層                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ Dify ワークフローエンジン                            │   │
│  │ - ワークフロー実行（ノード単位の処理）               │   │
│  │ - エージェントモード（ReAct / Function Calling）     │   │
│  │ - 条件分岐・ループ処理                               │   │
│  │ - 変数管理・コンテキスト引き継ぎ                     │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  第2層: 通信層（プロンプト層）                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ Dify プロンプトテンプレート                          │   │
│  │ - システムプロンプト設定                             │   │
│  │ - 変数埋め込み（{{variable}}）                       │   │
│  │ - コンテキスト注入（RAG結果の自動挿入）              │   │
│  │ - プロンプトオーケストレーション                     │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  第1層: LLM層                                                │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ Dify モデルプロバイダー統合                          │   │
│  │ - Claude (Anthropic)                                │   │
│  │ - GPT-4 / GPT-4o (OpenAI)                          │   │
│  │ - Gemini (Google)                                   │   │
│  │ - Mistral / Mixtral                                 │   │
│  │ - Llama / Qwen / その他オープンソースモデル         │   │
│  │ - ローカルモデル（Ollama連携）                       │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

## 階層構造の誤認候補 ✅対応済み
Ｋｉｒｎｏ４層が抜けている、４層で、プログラム作成したり、テストコード実行したりするよね？？
Claude Coworkでは、４層でデスクトップ操作だよね？？
Perplexityは、ツール利用型検索まではやってないの？？調査して、もしここまでやっていない場合はその旨明記して。従来型のアプリってこと。※検索日付を明記しつつ。

源内は、認識が不足している。
源内Webは、基本５層のみ。
源内アプリが複数あり、これがAPI連携する。
源内アプリ群は、UIレスの1~4層を持ったアプリ。
源内Webは、これらの源内アプリを束ねる5層の認証基盤の認識だけど、あっている？
デフォルトのチャット機能のみ、源内Web側で３層と１層を持っているが、４層連携はサポートしていない。
デジタル庁ブログを読んで、この理解であっているか確認して。

GenUも、基本５層のみ。3章の機能は薄い。

GenUでは、３層は基本AWSマネージドサービスがサポートしていて、
GenUの機能は５層のユーザ認証、ユースケース登録だけだと思う。
一部、ユースケース作成機能は、３章をサポートしています。
また、1層は、モデルだけじゃなくて、Compliphend（綴り違うかも）や、Lex、翻訳ツールなど、
Bedrock以外のAWSマネージドなサービスを含んでいるので、そんな感じで説明して。

→ **07_f_その他製品.mdを修正**:
- Kiro: 第4層（コード生成・テスト実行）を追加
- Claude Cowork: 第4層（デスクトップ操作・ファイル管理）を追加
- Perplexity: 従来型RAG（第2層A注入）であることを明記（2026年2月調査時点）
- 源内: 源内Web（第5層認証基盤）+ 源内アプリ群（第1〜4層）の構造を明確化
- GenU: 第5層中心 + AWS Comprehend/Lex/翻訳等の第1層サービスを追加

## ３章と５章の定義明確化 ✅対応済み
３層は、直接LLMとやり取りするアプリ層であり、一般的なアプリではない。

※一般的なレイヤードアーキテクチャtのアプリ層と勘違いしないように、アプリ層の名前自体を全体で変えても良いかも。LLM操作アプリ層みたいに。ユーザ認証などは、この３層にはふくまれず、基本５層のプレゼンテーション層みたいにしたい。ただし、ユーザ認証が波及していて権限制御する場合は、３章まで波及とします。

例えば、ワークフローはLLMを操作するアプリなので、３層です。

でも、統合ログ分析や、監視、ユーザ管理などは、直接LLMを操作しないので、５層です。
これらがLLM操作にフィードバックを与える場合は３層です。例えばHookを使った拒否とか。
５章も、プレゼンテーション層だと、このLLMに関係ないアプリ部分がなくなるので、もっといい言葉あれば変更して。

→ **全ドキュメントの層名を変更**:
- 第3層: 「アプリ層」→「LLMオーケストレーション層」（直接LLMとやり取りする層を明確化）
- 第5層: 「プレゼンテーション層」→「UI・運用層」（UIに加えて監視・ログ・ユーザ管理も含む）
- 修正対象ファイル: 03_アプリ層.md、05_プレゼンテーション層.md、06_早見表.md、08_相性問題.md、09_付録.md、04_外部ツール層.md 他

##


→ **新規作成**:
- 07_a_ClaudeCode.md — Claude Codeを5層モデルで解説
- 07_b_IDE統合AI.md — Cursor、VSCode Copilot、GitHub Copilotを比較解説
- 07_c_Dify.md — Difyを5層モデルで解説
- 07_d_フレームワーク.md — LangChain、Strands Agents、AgentCoreを比較解説
- 07_e_ChatGPT.md — ChatGPT Enterprise、GPTs、プロジェクトを解説
- 07_f_その他製品.md — Kiro、Claude Cowork、Perplexity、源内、Antigravity、GenUを解説

---

# 現在のファイル構成

## 基礎章
- 00_はじめに.md
- 01_LLM層.md
- 02_通信層.md
- 03_LLMオーケストレーション層.md ✅ファイル名変更済み
- 04_外部ツール層.md (a) MCP・RAG・ツール編
- 04_b_エージェント連携.md
- 04_c_Claude設定ファイル.md
- 05_UI運用層.md ✅ファイル名変更済み
- 06_早見表.md

## 製品解説章
- 07_a_ClaudeCode.md
- 07_b_IDE統合AI.md
- 07_c_Dify.md
- 07_d_フレームワーク.md
- 07_e_ChatGPT.md
- 07_f_その他製品.md
- 07_Claude_Cowork.md（旧版、07_fに統合検討）

## 補足章
- 08_相性問題.md
- 09_付録.md

---

## 整合性チェック結果（2026-02-22）

### 発見した問題

| # | ファイル | 行番号 | 問題の種類 | 詳細 |
|---|----------|--------|------------|------|
| 1 | 04_c_Claude設定ファイル.md | 5 | 相互参照エラー | `[03_アプリ層.md](./03_アプリ層.md)` - 旧ファイル名。正しくは `03_LLMオーケストレーション層.md` |
| 2 | 04_c_Claude設定ファイル.md | 649 | 相互参照エラー | `[03_アプリ層.md](./03_アプリ層.md)` - 旧ファイル名。正しくは `03_LLMオーケストレーション層.md` |
| 3 | 07_a_ClaudeCode.md | 318 | 相互参照エラー | `[03_アプリ層.md](./03_アプリ層.md)` - 旧ファイル名。正しくは `03_LLMオーケストレーション層.md` |
| 4 | 04_b_エージェント連携.md | 451 | 用語表記ゆれ | `第2層 構造化I/O層` - 基礎章では「通信層」と定義。「構造化I/O層」は古い名称 |
| 5 | 06_早見表.md | 51 | 表記の不整合 | `ツールの外部プログラム動作` の行で全角スペースが混在 |
| 6 | 01_LLM層.md | 90 | モデル名表記 | `claude-sonnet-4-6` - モデルIDの表記が簡略化されている（他ファイルとの統一要検討） |
| 7 | 02_通信層.md | 53 | モデル名表記 | `claude-sonnet-4-6` - 01_LLM層.mdと同様 |
| 8 | 02_通信層.md | 583-585 | モデル名表記 | `claude-sonnet-4-6` - 同上 |
| 9 | 05_UI運用層.md | 154 | モデル名表記 | `claude-sonnet-4-20250514` - ここは正式なモデルIDを使用。他ファイルとの表記統一が必要 |
| 10 | 07_d_フレームワーク.md | 143, 163 | モデル名表記 | `claude-sonnet-4-6` - 他ファイルとの統一要検討 |
| 11 | 08_相性問題.md | 105-106 | モデル名表記 | `Claude claude-sonnet-4-6` - `Claude` が重複している可能性 |
| 12 | 07_Claude_Cowork.md | 全体 | 重複コンテンツ | 07_f_その他製品.md の Claude Cowork セクションと内容が重複。統合を検討 |
| 13 | review.md | 19 | 古い情報の残存 | 「修正対象（完了）」リストに `03_アプリ層.md` という旧ファイル名が残存 |
| 14 | review.md | 57 | 古い層名の残存 | `第3層<br/>アプリ層` - 古い層名「アプリ層」の記載が残存 |
| 15 | review.md | 183 | 古い情報の残存 | 「修正対象ファイル: 03_アプリ層.md、05_プレゼンテーション層.md」- 旧ファイル名 |
| 16 | 02_通信層.md | 681-687 | 層定義の解釈 | `model`, `system/messages`, `tools[]` を「第1層（構造）」としているが、JSON構造は第2層に属すると解釈できる余地あり。基礎章00_はじめに.mdの定義との整合性要確認 |
| 17 | 06_早見表.md | 73 | 層定義の補足 | Kiroの行で「ファイル編集・テスト実行」を第4層としているが、基礎章の定義「外部ツール層」の説明と整合する説明が望ましい |
| 18 | 09_付録.md | 21 | 用語表記 | `Claude Code Subagent` - 他ファイルでは「サブエージェント」と表記。統一検討 |

### 問題のカテゴリ別サマリ

| カテゴリ | 件数 | 主な問題 |
|----------|------|----------|
| 相互参照エラー | 3件 | 旧ファイル名（03_アプリ層.md）への参照が残存 |
| 用語表記ゆれ | 2件 | 「構造化I/O層」「アプリ層」など旧名称の残存、サブエージェント/Subagent |
| モデル名表記 | 6件 | `claude-sonnet-4-6` vs `claude-sonnet-4-20250514` の不統一 |
| 重複コンテンツ | 1件 | 07_Claude_Cowork.md と 07_f_その他製品.md |
| 古い情報の残存（review.md内） | 3件 | 旧ファイル名・旧層名がreview.md履歴に残存 |
| 層定義の解釈 | 2件 | 第1層と第2層の境界が一部不明確 |

### 推奨アクション（優先度順）

1. **高優先度**: 相互参照エラーの修正（#1, #2, #3）
   - 04_c_Claude設定ファイル.md と 07_a_ClaudeCode.md 内の旧ファイル名参照を修正
2. **高優先度**: 用語表記ゆれの統一（#4）
   - 04_b_エージェント連携.md 内の「構造化I/O層」を「通信層」に修正
3. **中優先度**: モデル名表記の統一（#6-11）
   - `claude-sonnet-4-6` か `claude-sonnet-4-20250514` のいずれかに統一
4. **中優先度**: 07_Claude_Cowork.md の統合判断（#12）
   - 07_f_その他製品.md に統合するか、別ファイルとして維持するか決定
5. **低優先度**: review.md内の古い情報はそのまま（履歴として保持）（#13, #14, #15）
6. **低優先度**: 層定義の境界の明確化検討（#16, #17）

### 5層モデル定義の確認結果

基礎章（00_はじめに.md）で定義された5層モデル:
- 第1層: LLM層
- 第2層: 通信層（A: クライアント起点、B: LLM起点）
- 第3層: LLMオーケストレーション層
- 第4層: 外部ツール層
- 第5層: UI・運用層

各ドキュメントでこの定義は概ね一貫して使用されている。

### Mermaid図の構文確認結果

確認できる範囲で、Mermaid図の構文エラーは検出されなかった。

### 古い層名の確認結果

- 「アプリ層」: 04_b_エージェント連携.mdの一部、review.md（履歴）に残存
- 「プレゼンテーション層」: review.md（履歴、アスキーアートの例）のみに残存
- 「構造化I/O層」: 04_b_エージェント連携.mdに残存

---

## 第1層ファクトチェック結果（2026-02-22）

### 総合判定: 概ね正確

詳細レポート: `work/layer1_fact_check.md`

### 検証済み項目（正確性確認済み）

| 項目 | 記載内容 | 判定 |
|------|----------|------|
| Claude コンテキストウィンドウ | 200Kトークン | 正確（標準200K、Enterprise 500K、ベータ1M） |
| GPT-4系 コンテキストウィンドウ | 128K | 正確（GPT-4o時点、GPT-4.1は1M） |
| Gemini コンテキストウィンドウ | 1Mトークン | 正確（Gemini 1.5 Pro/2.5 Pro） |
| DeepSeek-V3 パラメータ | 685B総/37B活性化 | 正確 |
| Mixtral 8x7B パラメータ | 46B総/12B活性化 | 正確 |
| text-embedding-3-large 次元数 | 3072 | 正確 |
| voyage-3-large 次元数 | 1024 | 正確 |
| LoRA パラメータ更新量 | 0.1〜1% | 正確（GPT-3 175Bでは0.01%も可能） |
| Constitutional AI プロセス | 自己批判→修正→RLAIF | 正確 |
| Extended Thinking | budget_tokens制御 | 正確 |

### 発見した軽微な問題

| # | 項目 | 問題の種類 | 詳細 | 対応優先度 |
|---|------|-----------|------|------------|
| 29 | Llama 4情報 | 情報更新推奨 | Llama 4のMoEアーキテクチャ（Scout/Maverick/Behemoth）の詳細記載なし | 低 |
| 30 | モデル名表記 | 表記不整合 | 90行目「Claude claude-sonnet-4-6」- 既存の#11と同じ問題 | 中（#11と併せて対応） |

### ソース（主要）

- [Context windows - Claude API Docs](https://platform.claude.com/docs/en/build-with-claude/context-windows)
- [Building with extended thinking - Claude API Docs](https://platform.claude.com/docs/en/build-with-claude/extended-thinking)
- [Constitutional AI - Anthropic](https://www.anthropic.com/research/constitutional-ai-harmlessness-from-ai-feedback)
- [Reasoning models - OpenAI API](https://platform.openai.com/docs/guides/reasoning)
- [The Llama 4 herd - Meta AI](https://ai.meta.com/blog/llama-4-multimodal-intelligence/)
- [DeepSeek-V3 Technical Report](https://arxiv.org/abs/2412.19437)
- [Mixtral of experts - Mistral AI](https://mistral.ai/news/mixtral-of-experts)
- [LoRA原論文](https://arxiv.org/abs/2106.09685)

---

## 第3層ファクトチェック結果（2026-02-22）

### 発見した問題

| # | ファイル | 行番号 | 問題の種類 | 詳細 |
|---|----------|--------|------------|------|
| 19 | 03_LLMオーケストレーション層.md | 275-282 | 事実誤り | Hooksイベント数が不足（4種類のみ記載、実際は12種類）|
| 20 | 03_LLMオーケストレーション層.md | 281 | 事実誤り | SubagentStartの「ブロック可能」は誤り。正しくは「**ブロック不可**（コンテキスト注入は可能）」|
| 21 | 03_LLMオーケストレーション層.md | - | 内容不足 | ReActパターンの解説がない。主要なエージェントパターンとして追加を検討 |
| 22 | 03_LLMオーケストレーション層.md | 278 | 情報不足 | PreToolUseの入力修正機能（v2.0.10+）の記載がない |

### 推奨アクション（優先度順）

1. **高優先度**: Hooks仕様の修正（#19, #20, #22）
   - イベント数を12種類に拡充
   - SubagentStartのブロック可否を「不可」に修正
   - PreToolUseの入力修正機能を追記

2. **中優先度**: ReActパターンの追加（#21）
   - ワークフローパターンセクションにReActを追加

### 詳細レポート

詳細は `work/layer3_fact_check.md` を参照。

### ソース（主要）

- [Claude Code Hooks ドキュメント](https://code.claude.com/docs/en/hooks)
- [ReAct: Synergizing Reasoning and Acting](https://react-lm.github.io/)
- [Model Context Protocol Specification](https://modelcontextprotocol.io/specification/2025-11-25)

---

## 第5層・製品解説ファクトチェック結果（2026-02-22）

### 検証対象
- `output/05_UI運用層.md`
- `output/07_a_ClaudeCode.md`
- `output/07_f_その他製品.md`

詳細レポート: `work/layer5_fact_check.md`

### 発見した問題

| # | ファイル | 問題の種類 | 詳細 | 優先度 |
|---|----------|------------|------|--------|
| 23 | 07_f_その他製品.md | **事実誤り** | Kiro Specs構成:「Requirements, Design, Tasks, Tests」→ 正しくは3ファイル（requirements.md, design.md, tasks.md）。Testsは別ファイルではなくrequirements.mdの受け入れ基準に含まれる | 高 |
| 24 | 07_f_その他製品.md | **事実誤り** | GenU層構成:「第5層のみ」→ 正しくは「第5層中心 + 第3層の一部（Agent、RAG、Use Case Builder）」。GenUはRAG Chat、Agent機能、Use Case Builder等の第3層機能も持つ | 高 |
| 25 | 07_f_その他製品.md | 説明不足 | Perplexity: Sonar Pro API のagentic機能（search_classifier、multi-step reasoning）についての補足が必要。「従来型RAG」の記載は維持しつつ、APIのagentic機能について追記推奨 | 中 |
| 26 | 07_a_ClaudeCode.md | 情報更新推奨 | 最新機能の追記推奨: Claude in Chrome、Claude Agent SDK、Claude Code Security、npm非推奨化 | 中 |
| 27 | 07_a_ClaudeCode.md | 情報更新推奨 | モデル名: Claude Sonnet 4.6 / Opus 4.6 が最新モデル | 低 |
| 28 | 07_f_その他製品.md | 情報更新推奨 | Claude Cowork: 2026年2月11日のWindows版リリース情報が未記載 | 低 |

### 推奨アクション（優先度順）

#### 高優先度

1. **Kiro Specs構成の修正** (#23)
   ```
   修正前: Requirements, Design, Tasks, Tests（4要素）
   修正後: requirements.md, design.md, tasks.md（3ファイル）
   ```
   - Tests は requirements.md の受け入れ基準（EARS形式）に含まれる
   - 参照: https://kiro.dev/docs/specs/

2. **GenU層構成の修正** (#24)
   ```
   修正前: 第5層のみ（ユーザー認証 + ユースケース登録）
   修正後: 第5層中心 + 第3層の一部機能
   ```
   GenUは以下の第3層機能も持つ:
   - RAG Chat（Kendra / Knowledge Base連携）
   - Agent機能（Web Search Agent、Code Interpreter Agent）
   - Use Case Builder（プロンプトテンプレート管理）
   - Voice Chat、MCP Chat

#### 中優先度

3. **Perplexity説明の補足** (#25)
   - 現在の記載「従来型RAG」は基本動作として正確
   - Sonar Pro API では以下のagentic機能も提供:
     - search_classifier: 検索要否を動的判断
     - Pro Search mode: multi-step reasoning と tool execution

4. **Claude Code最新機能の追記** (#26)
   - Claude in Chrome (Beta): Chrome拡張との連携
   - Claude Agent SDK: 旧Claude Code SDK
   - Claude Code Security: 脆弱性スキャン機能
   - npm インストール非推奨化

### 確認できなかった項目

- **源内の詳細構造**: デジタル庁noteへのアクセスが制限されており、「源内Web」「源内アプリ群」の公式定義は確認できず。現在の記載内容は検索結果と矛盾しないが、公式確認が取れていない状態。

### ソース（主要）

- [Claude Code CHANGELOG](https://github.com/anthropics/claude-code/blob/main/CHANGELOG.md)
- [Kiro Docs - Specs](https://kiro.dev/docs/specs/)
- [GenU GitHub](https://github.com/aws-samples/generative-ai-use-cases)
- [Perplexity Architecture](https://www.frugaltesting.com/blog/behind-perplexitys-architecture-how-ai-search-handles-real-time-web-data)
- [Claude Cowork Getting Started](https://support.claude.com/en/articles/13345190-getting-started-with-cowork)

---

## 第2層ファクトチェック結果（2026-02-22）

### 総合判定: 概ね正確（軽微な更新推奨）

詳細レポート: `work/layer2_fact_check.md`

### 検証済み項目（正確性確認済み）

| 項目 | 記載内容 | 判定 |
|------|----------|------|
| OpenAI arguments形式 | 文字列化JSON（パース必要） | 正確 |
| Anthropic input形式 | オブジェクト（パース不要） | 正確 |
| Gemini args形式 | オブジェクト | 正確 |
| system配置（Anthropic） | 独立フィールド | 正確 |
| system配置（OpenAI） | messages[]の要素 | 正確 |
| system配置（Gemini） | systemInstruction独立フィールド | 正確 |
| tool_choice仕様 | 各社の形式 | 正確 |
| SSEストリーミング形式 | 各社の形式 | 正確 |
| PDF対応状況 | 各社の対応 | 正確 |

### 発見した問題

| # | ファイル | 行番号 | 問題の種類 | 詳細 |
|---|----------|--------|------------|------|
| 36 | 02_通信層.md | 543-544 | **事実誤り** | Anthropic URL参照「非対応」→ **対応済み**（2025年2-3月追加）。`source.type: "url"` 形式で利用可能 |
| 37 | 02_通信層.md | 556-561 | 情報不足 | Anthropic音声API（Voice API、WebSocket対応）の補足記載がない |
| 38 | 02_通信層.md | 374-375 | 情報不足 | Gemini Live API（WebSocket）の記載がない |
| 39 | 02_通信層.md | 374 | 表記更新推奨 | WebSocket対応表: Anthropic「非対応」→「対応（Voice API）」 |
| 40 | 02_通信層.md | 375 | **事実誤り** | WebSocket対応表: Gemini「非対応」→ **「対応（Live API）」** |

### 推奨アクション（優先度順）

#### 高優先度

1. **Anthropic URL参照の修正** (#36)
   - 修正箇所: 543-544行目のファイル転送方式表
   - 修正内容: URL参照「非対応」→「対応」
   - 補足追記: 「2025年2-3月頃追加」「`source.type: "url"` 形式」

#### 中優先度

2. **Gemini WebSocket対応の修正** (#40)
   - 修正箇所: 374-375行目の各社の対応表
   - 修正内容: Gemini WebSocket「非対応」→「対応（Live API）」
   - 補足: エンドポイント `wss://generativelanguage.googleapis.com/ws/...`

#### 低優先度

3. Anthropic Voice API（WebSocket）の補足記載 (#37, #39)
4. 音声・動画対応表の精緻化 (#38)

### ソース（主要）

- [Function calling | OpenAI API](https://developers.openai.com/api/docs/guides/function-calling/)
- [How to implement tool use - Claude API Docs](https://platform.claude.com/docs/en/agents-and-tools/tool-use/implement-tool-use)
- [Using Tools & Agents with Gemini API](https://ai.google.dev/gemini-api/docs/tools)
- [Vision - Claude API Docs](https://platform.claude.com/docs/en/build-with-claude/vision)
- [Live API - WebSockets API reference | Gemini API](https://ai.google.dev/api/live)
- [llm-anthropic #24: Use new URL parameter](https://simonwillison.net/2025/Mar/1/llm-anthropic/)

---

## 第4層ファクトチェック結果（2026-02-22）

### 総合判定: 概ね正確

詳細レポート: `work/layer4_fact_check.md`

### 検証対象
- `output/04_外部ツール層.md`
- `output/04_b_エージェント連携.md`

### 検証済み項目（正確性確認済み）

| 項目 | 記載内容 | 判定 |
|------|----------|------|
| MCP定義 | ツール定義を標準化・外部化するプロトコル | 正確 |
| MCPトランスポート | stdio（ローカル）、Streamable HTTP（リモート） | 正確 |
| MCP認証 | OAuth 2.0必須（リモート） | 正確（OAuth 2.1推奨） |
| A2A策定元 | Google発 | 正確（2025年4月発表） |
| A2A通信方式 | JSON-RPC 2.0 over HTTP/SSE | 正確 |
| Agent Card | /.well-known/agent.json | 正確 |
| 従来型RAG vs Tool型RAG | アプリ制御 vs LLM主導 | 正確 |
| ベクトルDB（Pinecone, Chroma, Qdrant） | RAG用意味検索 | 正確 |
| Replit事例 | 2025年7月、1,200件以上削除 | 正確 |
| サブエージェント | Taskツール、複数子起動可能 | 正確 |
| Agent Teams | タスクボード、SendMessage | 正確 |

### 発見した問題

| # | ファイル | 行番号 | 問題の種類 | 詳細 |
|---|----------|--------|------------|------|
| 29 | 04_b_エージェント連携.md | 217-219 | 情報不足 | Agent Teamsが実験的機能（experimental）であることの明記がない |
| 30 | 04_b_エージェント連携.md | 217-219 | 情報不足 | 有効化に環境変数（CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS）が必要なことの記載がない |
| 31 | 04_b_エージェント連携.md | 106-125 | 情報不足 | 組み込みサブエージェント（Explore、Plan）の記載がない |
| 32 | 04_外部ツール層.md | 122 | 情報更新推奨 | ベクトルDB一覧にWeaviateがない（主要DBとして追加検討） |

### 推奨アクション（優先度順）

1. **中優先度**: Agent Teamsの実験的機能ステータスと有効化方法を追記（#29, #30）
   - 04_b_エージェント連携.mdのセクション4-1に以下を追加:
     - 「Agent Teamsは実験的機能でデフォルト無効」
     - 「CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS環境変数で有効化」
2. **低優先度**: 組み込みサブエージェント（Explore、Plan）の説明を追加（#31）
3. **低優先度**: ベクトルDB一覧にWeaviateを追加（#32）

### MCP最新情報（2025-2026）

| 日付 | イベント |
|------|----------|
| 2024年11月 | Anthropic がMCPを発表 |
| 2025年3月 | OpenAI がMCPを採用 |
| 2025年6月18日 | Streamable HTTP正式化、SSEを非推奨化 |
| 2025年8月 | Microsoft Build でWindows統合を発表 |
| 2025年11月25日 | 最新仕様バージョン |
| 2025年12月 | Agentic AI Foundation（Linux Foundation）へ寄贈 |

### A2A最新情報（2025-2026）

| 日付 | イベント |
|------|----------|
| 2025年4月9日 | Google Cloud Next で発表 |
| 2025年7月31日 | v0.3リリース（gRPCサポート追加） |
| 2025年（詳細日不明） | Linux Foundation へ寄贈 |
| 2026年 | A2UI（Agent-to-UI）が追加発表 |

### ソース（主要）

- [MCP Specification (2025-11-25)](https://modelcontextprotocol.io/specification/2025-11-25)
- [Google Developers Blog - A2A Announcement](https://developers.googleblog.com/en/a2a-a-new-era-of-agent-interoperability/)
- [Claude Code Agent Teams Docs](https://code.claude.com/docs/en/agent-teams)
- [Claude Code Sub-agents Docs](https://code.claude.com/docs/en/sub-agents)
- [A2A Protocol Specification](https://a2a-protocol.org/latest/specification/)

---

## 高優先度問題の修正完了（2026-02-22）

### 修正済み項目

| # | ファイル | 問題 | 修正内容 | ステータス |
|---|----------|------|----------|------------|
| 1 | 04_c_Claude設定ファイル.md | 旧ファイル名参照（2箇所） | `03_アプリ層.md` → `03_LLMオーケストレーション層.md` | ✅完了 |
| 2 | 07_a_ClaudeCode.md | 旧ファイル名参照（1箇所） | `03_アプリ層.md` → `03_LLMオーケストレーション層.md` | ✅完了 |
| 3 | 04_b_エージェント連携.md | 用語表記ゆれ | `構造化I/O層` → `通信層` | ✅完了 |
| 4 | 02_通信層.md | Anthropic URL参照の誤り | `非対応` → `対応` | ✅完了 |
| 5 | 02_通信層.md | Gemini WebSocket対応の誤り | `非対応` → `対応（Live API）` | ✅完了 |
| 6 | 03_LLMオーケストレーション層.md | Hooksイベント数不足 | 4種類 → 12種類に拡充 | ✅完了 |
| 7 | 03_LLMオーケストレーション層.md | SubagentStartブロック可否 | `ブロック可能` → `ブロック不可` | ✅完了 |
| 8 | 03_LLMオーケストレーション層.md | PreToolUse新機能 | v2.0.10/v2.1.9の機能追記 | ✅完了 |
| 9 | 07_f_その他製品.md | Kiro Specs構成 | 4要素 → 3ファイル（tests含まず） | ✅完了 |
| 10 | 07_f_その他製品.md | GenU層構成 | `第5層のみ` → `第5層中心+第3層の一部` | ✅完了 |
| 11 | 04_b_エージェント連携.md | Agent Teams情報不足 | 実験的機能ステータス・有効化方法追記 | ✅完了 |
| 12 | 04_b_エージェント連携.md | 組み込みサブエージェント | Explore、Planの説明追加 | ✅完了 |

### 新規性分析完了

- 類似記事・書籍: 23件を特定
- 本記事の独自性を分析
- 参考文献を09_付録.mdに追加
- 詳細: `work/novelty_analysis.md`

### 作成されたworkファイル

| ファイル | 内容 |
|----------|------|
| `work/layer1_fact_check.md` | 第1層ファクトチェック詳細 |
| `work/layer2_fact_check.md` | 第2層ファクトチェック詳細 |
| `work/layer3_fact_check.md` | 第3層ファクトチェック詳細 |
| `work/layer4_fact_check.md` | 第4層ファクトチェック詳細 |
| `work/layer5_fact_check.md` | 第5層・製品ファクトチェック詳細 |
| `work/novelty_analysis.md` | 新規性分析レポート |

### 残存する低優先度問題

| # | 問題 | 対応方針 | ユーザ解答|
|---|------|----------|---|
| モデル名表記不統一 | `claude-sonnet-4-6` vs `claude-sonnet-4-20250514` | ユーザー判断待ち |claude-sonnet-4-6 にして|
| 07_Claude_Cowork.md重複 | 07_f統合 or 別ファイル維持 | ユーザー判断待ち |　07_fへ統合 |
| review.md内の古い履歴 | 履歴として保持（修正不要） | 対応不要 | /reviewフォルダを作成し、ファイル分割して保存。yyyymmdd-01_review.md みたいな形式にして、ある程度たまったら随時保存。|
